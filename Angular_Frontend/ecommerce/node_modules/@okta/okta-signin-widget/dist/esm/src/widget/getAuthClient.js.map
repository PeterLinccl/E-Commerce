{"version":3,"file":"getAuthClient.js","sources":["../../../../src/widget/getAuthClient.ts"],"sourcesContent":["import { ConfigError } from 'util/Errors';\nimport Util from 'util/Util';\nimport config from 'config/config.json';\nimport { WidgetOptions, WidgetOktaAuthConstructor, WidgetOktaAuthInterface } from 'types';\n\nexport default function getAuthClientInstance(\n  OktaAuth: WidgetOktaAuthConstructor,\n  options: WidgetOptions = {}\n): WidgetOktaAuthInterface\n{\n  // if authClient is set, authParams are disregarded\n  let { authClient, authParams } = options;\n\n  if (!authClient) {\n    // Create an authClient using widget options and optional authParams\n    const {\n      issuer,\n      clientId,\n      redirectUri,\n      state,\n      scopes,\n      flow,\n      codeChallenge,\n      codeChallengeMethod,\n      recoveryToken\n    } = options;\n    authParams = {\n      issuer,\n      clientId,\n      redirectUri,\n      state,\n      scopes,\n      flow,\n      codeChallenge,\n      codeChallengeMethod,\n      transformErrorXHR: Util.transformErrorXHR,\n      recoveryToken,\n      ...authParams\n    };\n\n    if (!authParams.issuer) {\n      authParams.issuer = options.baseUrl + '/oauth2/default';\n    }\n\n    authClient = new OktaAuth(authParams);\n  }\n\n  // Add widget version to extended user agent header\n  if (!authClient._oktaUserAgent) {\n    throw new ConfigError('The passed in authClient should be version 5.4.0 or above.');\n  } else {\n    authClient._oktaUserAgent.addEnvironment(`okta-signin-widget-${config.version}`);\n  }\n\n  return authClient;\n}\n"],"names":["getAuthClientInstance","OktaAuth","options","authClient","authParams","issuer","clientId","redirectUri","state","scopes","flow","codeChallenge","codeChallengeMethod","recoveryToken","transformErrorXHR","Util","baseUrl","_oktaUserAgent","ConfigError","addEnvironment","config","version"],"mappings":";;;;AAKe,SAASA,qBAAT,CACbC,QADa,EAEbC,OAAsB,GAAG,EAFZ,EAIf;AACE;AACA,EAAI,IAAA;AAAEC,IAAAA,UAAU,EAAVA,UAAF;AAAcC,IAAAA,UAAU,EAAVA,UAAAA;AAAd,GAAA,GAA6BF,OAAjC,CAAA;;AAEA,EAAI,IAAA,CAACC,UAAL,EAAiB;AACf;AACA,IAAM,MAAA;AACJE,MAAAA,MAAM,EAANA,MADI;AAEJC,MAAAA,QAAQ,EAARA,QAFI;AAGJC,MAAAA,WAAW,EAAXA,WAHI;AAIJC,MAAAA,KAAK,EAALA,KAJI;AAKJC,MAAAA,MAAM,EAANA,MALI;AAMJC,MAAAA,IAAI,EAAJA,IANI;AAOJC,MAAAA,aAAa,EAAbA,aAPI;AAQJC,MAAAA,mBAAmB,EAAnBA,mBARI;AASJC,MAAAA,aAAa,EAAbA,aAAAA;AATI,KAAA,GAUFX,OAVJ,CAAA;AAWAE,IAAAA,UAAU,GAAG;AACXC,MAAAA,MAAM,EAANA,MADW;AAEXC,MAAAA,QAAQ,EAARA,QAFW;AAGXC,MAAAA,WAAW,EAAXA,WAHW;AAIXC,MAAAA,KAAK,EAALA,KAJW;AAKXC,MAAAA,MAAM,EAANA,MALW;AAMXC,MAAAA,IAAI,EAAJA,IANW;AAOXC,MAAAA,aAAa,EAAbA,aAPW;AAQXC,MAAAA,mBAAmB,EAAnBA,mBARW;AASXE,MAAAA,iBAAiB,EAAEC,IAAI,CAACD,iBATb;AAUXD,MAAAA,aAAa,EAAbA,aAVW;AAWX,MAAGT,GAAAA,UAAAA;AAXQ,KAAb,CAAA;;AAcA,IAAA,IAAI,CAACA,UAAU,CAACC,MAAhB,EAAwB;AACtBD,MAAAA,UAAU,CAACC,MAAX,GAAoBH,OAAO,CAACc,OAAR,GAAkB,iBAAtC,CAAA;AACD,KAAA;;AAEDb,IAAAA,UAAU,GAAG,IAAIF,QAAJ,CAAaG,UAAb,CAAb,CAAA;AACD,GApCH;;;AAuCE,EAAA,IAAI,CAACD,UAAU,CAACc,cAAhB,EAAgC;AAC9B,IAAA,MAAM,IAAIC,WAAJ,CAAgB,4DAAhB,CAAN,CAAA;AACD,GAFD,MAEO;AACLf,IAAAA,UAAU,CAACc,cAAX,CAA0BE,cAA1B,CAA0C,CAAqBC,mBAAAA,EAAAA,MAAM,CAACC,OAAQ,CAA9E,CAAA,CAAA,CAAA;AACD,GAAA;;AAED,EAAA,OAAOlB,UAAP,CAAA;AACD;;;;"}